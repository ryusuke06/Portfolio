<%= render "admins/tops/header" %>
<div class="container">
  <h3 class="admins_index">診断一覧</h3>
  <div align="right">
    <%= link_to new_admins_test_path do %>
      <i class="glyphicon glyphicon-plus-sign" aria-hidden="true"></i>
    <% end %>
  </div>

  <div class="row">
  	<table class="table table-bordered center">
      <thead>
        <th>診断ID</th>
        <th>診断名</th>
        <th>ジャンル</th>
        <th>平均評価</th>
        <th>公開ステータス</th>
      </thead>
		  <% @tests.each do |test| %>
        <tr>
          <td>
            <%= test.id %>
          </td>
          <td>
            <%= link_to "#{test.title}", admins_test_path(id: test.id) %>
          </td>
          <td>
            <%= test.category %>
          </td>
          <td>
            <div id="star-rate-<%= test.id %>"></div>
            <!--indexの一覧評価を平均値で出す。round関数で切り上げている。0.5毎にする方法は後で考える-->
            <script>
            $("#star-rate-<%= test.id %>").raty({
              size: 36,
              starOff: "<%= asset_path("star-off.png") %>",
              starOn: "<%= asset_path("star-on.png") %>",
              starHalf: "<%= asset_path("star-half.png") %>",
              half: true,
              readOnly: true,
              score: "<%= test.assessments.average(:rate).to_f.round(1) %>",
              });
            </script>
          </td>
          <td>
            <%= test.disclose %>
          </td>
    	  </tr>
      <% end %>
    </table>
  </div>
</div>

